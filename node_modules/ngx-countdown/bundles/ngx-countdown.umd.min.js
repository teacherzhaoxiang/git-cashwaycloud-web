!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define("ngx-countdown",["exports","@angular/core","@angular/common"],n):n((t=t||self)["ngx-countdown"]={},t.ng.core,t.ng.common)}(this,(function(t,n,e){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var o,i=function(){return(i=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)};function s(t,n,e,o){var i,s=arguments.length,r=s<3?n:null===o?o=Object.getOwnPropertyDescriptor(n,e):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,n,e,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(s<3?i(r):s>3?i(n,e,r):i(n,e))||r);return s>3&&r&&Object.defineProperty(n,e,r),r}function r(t,n){return function(e,o){n(e,o,t)}}function a(t,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,n)}(o=t.CountdownStatus||(t.CountdownStatus={}))[o.ing=0]="ing",o[o.pause=1]="pause",o[o.stop=2]="stop",o[o.done=3]="done";var u=function(){function t(t){this.ngZone=t,this.fns=[],this.commands=[],this.ing=!1}return t.prototype.start=function(){var t=this;!0!==this.ing&&(this.ing=!0,this.nextTime=+new Date,this.ngZone.runOutsideAngular((function(){t.process()})))},t.prototype.process=function(){for(var t=this;this.commands.length;)this.commands.shift()();var n=+new Date-this.nextTime,e=1+Math.floor(n/100);n=100-n%100,this.nextTime+=100*e;for(var o=0,i=this.fns.length;o<i;o+=2){var s=this.fns[o+1];if(0===s)this.fns[o](e);else{s+=2*e-1;var r=Math.floor(s/20);r>0&&this.fns[o](r),this.fns[o+1]=s%20+1}}this.ing&&setTimeout((function(){return t.process()}),n)},t.prototype.add=function(t,n){var e=this;return this.commands.push((function(){e.fns.push(t),e.fns.push(1e3===n?1:0),e.ing=!0})),this},t.prototype.remove=function(t){var n=this;return this.commands.push((function(){var e=n.fns.indexOf(t);-1!==e&&n.fns.splice(e,2),n.ing=n.fns.length>0})),this},t.ctorParameters=function(){return[{type:n.NgZone}]},t=s([n.Injectable(),a("design:paramtypes",[n.NgZone])],t)}(),f=function(){function t(t){var n=this;this.locale=t,this.demand=!1,this.leftTime=0,this.format="HH:mm:ss",this.timezone="+0000",this.formatDate=function(t){var o=t.date,i=t.formatStr,s=t.timezone;return e.formatDate(new Date(o),i,n.locale,s||n.timezone||"+0000")}}return t.ctorParameters=function(){return[{type:String,decorators:[{type:n.Inject,args:[n.LOCALE_ID]}]}]},t.ngInjectableDef=n.ɵɵdefineInjectable({factory:function(){return new t(n.ɵɵinject(n.LOCALE_ID))},token:t,providedIn:"root"}),t=s([n.Injectable({providedIn:"root"}),r(0,n.Inject(n.LOCALE_ID)),a("design:paramtypes",[String])],t)}(),c=function(){function e(e,o,i,s,r){this.locale=e,this.timer=o,this.defCog=i,this.cdr=s,this.ngZone=r,this.frequency=1e3,this._notify={},this.status=t.CountdownStatus.ing,this.isDestroy=!1,this.i={},this.left=0,this.event=new n.EventEmitter}return e.prototype.begin=function(){this.status=t.CountdownStatus.ing,this.callEvent("start")},e.prototype.restart=function(){this.status!==t.CountdownStatus.stop&&this.destroy(),this.init(),this.callEvent("restart")},e.prototype.stop=function(){this.status!==t.CountdownStatus.stop&&(this.status=t.CountdownStatus.stop,this.destroy(),this.callEvent("stop"))},e.prototype.pause=function(){this.status!==t.CountdownStatus.stop&&this.status!==t.CountdownStatus.pause&&(this.status=t.CountdownStatus.pause,this.callEvent("pause"))},e.prototype.resume=function(){this.status!==t.CountdownStatus.stop&&this.status===t.CountdownStatus.pause&&(this.status=t.CountdownStatus.ing,this.callEvent("resume"))},e.prototype.callEvent=function(t){this.event.emit({action:t,left:this.left,status:this.status,text:this.i.text})},e.prototype.init=function(){var n=this,e=this.locale,o=this.defCog,s=this.config=i({},new f(e),o,this.config),r=this.frequency=~s.format.indexOf("S")?100:1e3;this.status=s.demand?t.CountdownStatus.pause:t.CountdownStatus.ing,this.getLeft();var a=this.reflow;this.reflow=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=!1),a.apply(n,[t,e])},Array.isArray(s.notify)&&s.notify.forEach((function(t){if(t<1)throw new Error("The notify config must be a positive integer.");t*=1e3,t-=t%r,n._notify[t]=!0})),this.timer.add(this.reflow,r).start(),this.reflow(0,!0)},e.prototype.destroy=function(){return this.timer.remove(this.reflow),this},e.prototype.reflow=function(n,e){var o=this;if(void 0===n&&(n=0),void 0===e&&(e=!1),!this.isDestroy){var i=this.status,s=this.config,r=this._notify;if(e||i===t.CountdownStatus.ing){var a=this.left=this.left-this.frequency*n;this.i={value:a,text:s.formatDate({date:a,formatStr:s.format,timezone:s.timezone})},"function"==typeof s.prettyText&&(this.i.text=s.prettyText(this.i.text)),this.cdr.detectChanges(),(0===s.notify||r[a])&&this.ngZone.run((function(){o.callEvent("notify")})),a<1&&this.ngZone.run((function(){o.status=t.CountdownStatus.done,o.callEvent("done"),o.destroy()}))}}},e.prototype.getLeft=function(){var t=this.config,n=this.frequency,e=1e3*t.leftTime,o=t.stopTime;!e&&o&&(e=o-(new Date).getTime()),this.left=e-e%n},e.prototype.ngOnInit=function(){this.init(),this.config.demand||this.begin()},e.prototype.ngOnDestroy=function(){this.isDestroy=!0,this.destroy()},e.prototype.ngOnChanges=function(t){t.config.firstChange||this.restart()},e.ctorParameters=function(){return[{type:String,decorators:[{type:n.Inject,args:[n.LOCALE_ID]}]},{type:u},{type:f},{type:n.ChangeDetectorRef},{type:n.NgZone}]},s([n.Input(),a("design:type",Object)],e.prototype,"config",void 0),s([n.Input(),a("design:type",n.TemplateRef)],e.prototype,"render",void 0),s([n.Output(),a("design:type",Object)],e.prototype,"event",void 0),e=s([n.Component({selector:"countdown",template:'\n    <ng-container *ngIf="!render">\n      <span [innerHTML]="i.text"></span>\n    </ng-container>\n    <ng-container *ngTemplateOutlet="render; context: { $implicit: i }"></ng-container>\n  ',host:{"[class.count-down]":"true"},encapsulation:n.ViewEncapsulation.None,changeDetection:n.ChangeDetectionStrategy.OnPush}),r(0,n.Inject(n.LOCALE_ID)),a("design:paramtypes",[String,u,f,n.ChangeDetectorRef,n.NgZone])],e)}(),h=function(){function t(){}return t=s([n.NgModule({imports:[e.CommonModule],providers:[u],declarations:[c],exports:[c]})],t)}();t.CountdownComponent=c,t.CountdownGlobalConfig=f,t.CountdownModule=h,t.CountdownTimer=u,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-countdown.umd.min.js.map